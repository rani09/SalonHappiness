<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>

    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
    <!--
    CSS
    ============================================= -->
    <link rel="stylesheet" href="~/Content/vendors/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="~/Content/vendors/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="~/Content/vendors/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="~/Content/vendors/flat-icon/flaticon.css">
    <link rel="stylesheet" href="~/Content/vendors/nice-select/nice-select.css">
    <link rel="stylesheet" href="~/Content/vendors/Magnific-Popup/magnific-popup.css">
    <link rel="stylesheet" href="~/Content/vendors/OwlCarousel/owl.theme.default.min.css">
    <link rel="stylesheet" href="~/Content/vendors/OwlCarousel/owl.carousel.min.css">
    <link rel="stylesheet" href="~/Content/PagedList.css" />
    <link href="~/Content/css/SalonHappiness.css" rel="stylesheet" />
    <link href="~/Content/jquery.datetimepicker.css" rel="stylesheet" />

    <!--
    Google Font
    =========================== -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,600,700" rel="stylesheet">
</head>
<body>
    <div>
        @RenderBody()
    </div>



    <!-- ================ End footer Area ================= -->
    @*<p>&copy; @DateTime.Now.Year - My ASP.NET Application</p>*@


    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)


    <!--
    JavaScripts
    ========================== -->
    <script src="~/Content/vendors/jquery/jquery-3.2.1.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.12.1.min.js"></script>
    <script src="~/Scripts/jquery.validate.js"></script>
    <script src="~/Scripts/moment.js"></script>
    <script src="~/Scripts/jquery.datetimepicker.js"></script>
    <script src="~/Content/vendors/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="~/Content/vendors/OwlCarousel/owl.carousel.min.js"></script>
    <script src="~/Content/vendors/sticky/jquery.sticky.js"></script>
    <script src="~/Scripts/js/jquery.ajaxchimp.min.js"></script>
    <script src="~/Content/vendors/Magnific-Popup/jquery.magnific-popup.min.js"></script>
    <script src="~/Scripts/js/main.js"></script>
    <script src="~/Scripts/js/OpenTime.js"></script>
    <script src="~/Scripts/js/Select.js"></script>
    <script src="~/Scripts/booking.js"></script>
    @Html.Partial("_Notify")
    <script type="text/javascript">

        //console.clear();

        var schedule_week = ["09:30", "09:45", "10:00", "10:15", "10:30", "10:45", "11:00",
            "11:15", "11:30", "11:45", "12:00", "12:15", "12:30", "12:45", "13:00", "13:15",
            "13:30", "13:45", "14:00", "14:15", "14:30", "14:45", "15:00", "15:15", "15:30",
            "15:45", "16:00", "16:15", "16:30", "16:45", "17:00", "17:15", "17:30"];


        var schedule_saturday = ["09:00", "09:15", "09:30", "09:45", "10:00", "10:15", "10:30", "10:45", "11:00",
            "11:15", "11:30", "11:45", "12:00", "12:15", "12:30", "12:45", "13:00", "13:15",
            "13:30", "13:45", "14:00"];

        var prev_dayNum;
        var schedule_used = schedule_week;  // Use the week schedule by default.

        // Function to initialise the time picker input.
        function initTime() {
            $('#timePicker').datetimepicker({
                inline: true,
                format: 'H:i',
                datepicker: false,
                step: 15,
                allowTimes: schedule_used
            });
        }
        // On load time initialisation.
        initTime();
        $('#datePicker').datetimepicker({
            inline: true,
            format: 'd/m/Y',
            disabledWeekDays: [0],
            step: 15,
            lang: 'da',
            minDate: 0,
            validateOnBlur: false,
            timepicker: false,
            dayOfWeekStart: 1,

            // On change callback
            onChangeDateTime: function (dp, $input) {

                var dateVal = $input.val();
                var timeVal = $('#timePicker').val();
                //console.log(dateVal + " - " + (timeVal || "No Time"));

                // Because of the d/m/Y format, have to process the date a bit to get the day number.
                val = dateVal.split("/");
                var dayNum = new Date(val[2] + "/" + val[1] + "/" + val[0]).getDay();
                //console.log("dayNum: " + dayNum);

                // if dayNum is zero (sunday), use sunday schedule... Else use the week schedule.
                schedule_used = (dayNum == 6) ? schedule_saturday : schedule_week;

                // If the dayNum changed.
                if (prev_dayNum != dayNum) {
                    //console.log("Changed day!");
                    // Re-initialise datetimepicker
                    $('#timePicker').datetimepicker("destroy");
                    initTime();

                    // If the actual time value is not in schedule.
                    if ($.inArray(timeVal, schedule_used) == -1) {
                        //console.log("Wrong time!");
                        // Clear the time value.
                        $('#timePicker').val("");
                        // Focus the time input so it's obvious the user has to re-select a time.
                        $('#timePicker').focus();
                    }
                }
            }
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {

            $.validator.addMethod('ArrivelDate', function (value, element, param) {
                var dateRegex = /^([0-2][0-9]|(3)[0-1])(\/)(((0)[0-9])|((1)[0-2]))(\/)\d{4}$/;
                return value.match(dateRegex);
            }, 'Indtast venligst en gyldig dato!');

            $.validator.addMethod('ArrivelTime', function (value, element, param) {
                var timeRegex = /^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$/;
                return value.match(timeRegex);
            }, 'Indtast venligst en gyldig tid!');

            $.validator.addMethod("checkboxRequired", function (val, element, param) {
                return param && $(param).is(':checked')
            }, "Vælg mindst 1 af services");

            jQuery.validator.addClassRules('checkbox-validate', {
                checkboxRequired: '.checkbox-validate'
            });
            var val = {
                // Specify validation rules
                rules: {
                    ArrivelDate:
                    {
                        required: true
                    },
                    ArrivelTime:
                    {
                        required: true
                    }
                },
                // Specify validation error messages
                messages: {
                    ArrivelDate:
                    {
                        required: "vælg en dato fra kalender"
                    },
                    ArrivelTime:
                    {
                        required: "vælg en tid fra listen"
                    }
                },
                errorPlacement: function (error, element) {
                    if (element.hasClass('checkbox-validate')) {
                        element.closest('.form-group').find('.error-holder').html(error)
                    } else {
                        error.insertAfter(element);
                    }
                }
            }
            $("#myForm").multiStepForm({

                validations: val,
            }
            ).navigateTo(0);
        });
        function myFunction() {

            var x = document.getElementById("datePicker");
            var div = document.getElementById('date-result');
            div.innerHTML = x.value;

            var y = document.getElementById("timePicker");
            var t = document.getElementById('time-result');
            t.innerHTML = y.value;
        }

        function updateTextArea() {
            var allVals = [];
            $('#check_container_div :checked').each(function () {
                allVals.push($(this).attr('id'));
            });
            $('#service-result').val(allVals);
        }
        $(function () {
            $('#check_container_div input').click(updateTextArea);
            updateTextArea();
        });

        var arr = $('#check_container_div :checked').map(function () {
            return $(this).val();
        });
        $('#service-result').val(arr + "\n" + arr[0] + "\n" + arr.length);


        $('#check_container_div :checkbox').on('change', function () {
            var result = "";
            var how_many_checked = $('#check_container_div :checkbox:checked').length;

            $('#check_container_div :checked').each(function (index, value) {
                result += $(this).attr('id') + "\n";

            });
            $('#service-result').val(result);
        });

    </script>
</body>
</html>